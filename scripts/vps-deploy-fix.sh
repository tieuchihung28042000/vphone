#!/bin/bash

echo "ğŸš€ Deploying fixes to VPS..."

# Instructions for user to run on VPS
echo "ğŸ“‹ INSTRUCTIONS TO RUN ON VPS:"
echo "================================"
echo "1. SSH to your VPS"
echo "2. cd ~/sites/nguyenkieuanh.com"
echo "3. Run the following commands:"
echo ""
echo "# Pull latest code"
echo "git pull origin main"
echo ""
echo "# Rebuild containers"
echo "docker-compose down"
echo "docker-compose up --build -d"
echo ""
echo "# Wait for containers to start"
echo "sleep 10"
echo ""
echo "# Test the fix"
echo "curl -X GET https://nguyenkieuanh.com/api/test-user-creation"
echo ""
echo "# Test user creation with valid data"
echo "curl -X POST https://nguyenkieuanh.com/api/auth/register \\"
echo "  -H \"Content-Type: application/json\" \\"
echo "  -d '{"
echo "    \"email\": \"testuser$(date +%s)@vphone.com\","
echo "    \"password\": \"123456\","
echo "    \"full_name\": \"Test User\","
echo "    \"role\": \"admin\","
echo "    \"branch_id\": \"686783939535a971dfe22f4f\""
echo "  }'"
echo ""
echo "================================"
echo ""
echo "ğŸ”§ Current status: Code has been committed and pushed to GitHub"
echo "ğŸ“¦ Latest commit includes:"
echo "  - âœ… Fixed username null error"
echo "  - âœ… Added username input field"
echo "  - âœ… Backend handles empty string -> null conversion"
echo "  - âœ… All return functionality routes are ready"
echo "  - âœ… Tab máº·c Ä‘á»‹nh Quáº£n lÃ½ User Ä‘á»•i thÃ nh 'Táº¥t cáº£ user'"
echo "  - âœ… PhÃ¢n quyá»n Sá»• quá»¹ chá»‰ cho admin vÃ  quáº£n lÃ½"
echo ""
echo "âš ï¸  VPS needs to pull the latest code and rebuild containers"
echo "ğŸ’¡ After deployment, both user creation and return functionality should work" 